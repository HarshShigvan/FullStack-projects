<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud-Synced To-Do PWA</title>
    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="style.css"> 
</head>
<body class="transition-colors">

    <div class="app-container rounded-xl shadow-2xl">
        <h1 class="text-3xl font-bold text-gray-800 dark:text-gray-100 mb-6 text-center transition-colors">
            Cloud To-Do PWA
        </h1>

        <!-- User Info -->
        <div class="flex items-center justify-between mb-4 p-3 bg-gray-100 dark:bg-gray-700 rounded-lg">
            <p class="text-sm text-gray-700 dark:text-gray-300">
                <span id="user-display" class="font-semibold">Loading User...</span>
            </p>
            <div id="auth-container" class="flex items-center">
                <button id="google-signin-btn" class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg shadow transition-colors">
                    Sign In with Google
                </button>
                <button id="signout-btn" class="hidden px-3 py-1 bg-red-500 hover:bg-red-600 text-white text-sm rounded-lg shadow transition-colors ml-2">
                    Sign Out
                </button>
                <button id="theme-toggle" class="px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white text-sm rounded-lg shadow transition-colors ml-2">
                    Toggle Theme
                </button>
            </div>
        </div>

        <!-- Search and Sort Controls -->
        <div class="flex flex-col sm:flex-row gap-2 mb-4">
            <input type="text" id="search-input" placeholder="Search tasks..." class="flex-grow p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition">
            <select id="sort-select" class="p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg transition">
                <option value="creation">Sort by Creation</option>
                <option value="deadline">Sort by Deadline</option>
                <option value="text">Sort by Text</option>
            </select>
        </div>
        
        <!-- Filter Buttons (Responsive Stack) -->
        <div id="filter-container" class="grid grid-cols-2 sm:grid-cols-4 gap-2 mb-4">
            <button class="filter-btn p-2 rounded-lg text-sm transition-colors active" data-category="All">All</button>
            <button class="filter-btn p-2 rounded-lg text-sm transition-colors" data-category="Personal">Personal</button>
            <button class="filter-btn p-2 rounded-lg text-sm transition-colors" data-category="Work">Work</button>
            <button class="filter-btn p-2 rounded-lg text-sm transition-colors" data-category="Urgent">Urgent</button>
        </div>

        <!-- New Task Inputs (Flex Wrap on Mobile) -->
        <div class="flex flex-wrap gap-2 mb-4">
            <select id="category-select" class="p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg transition flex-grow w-full sm:w-auto sm:flex-none">
                <option value="Personal">Personal</option>
                <option value="Work">Work</option>
                <option value="Urgent">Urgent</option>
            </select>
            <input type="date" id="deadline-input" class="p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg transition flex-grow w-full sm:w-auto sm:flex-none">
        </div>

        <!-- Text Input and Action Buttons -->
        <div class="flex gap-2 mb-4">
            <input type="text" id="todo-input" placeholder="Enter new task or say task..." class="flex-grow p-3 border border-indigo-400 dark:border-indigo-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition">
            <button id="mic-button" class="p-3 bg-red-500 hover:bg-red-600 text-white rounded-lg shadow transition-colors w-12 flex items-center justify-center">
                <!-- Microphone Icon (Inline SVG) -->
                <svg id="mic-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mic"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></svg>
                <svg id="mic-stop-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-x hidden"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
            </button>
        </div>
        
        <div class="flex gap-2 mb-6">
            <button id="add-button" class="flex-grow p-3 bg-indigo-500 hover:bg-indigo-600 text-white font-semibold rounded-lg shadow transition-colors">
                Add Task
            </button>
            <button id="clear-all-button" class="w-1/3 p-3 bg-gray-400 hover:bg-gray-500 text-white font-semibold rounded-lg shadow transition-colors">
                Clear All
            </button>
        </div>

        <!-- Task List Container -->
        <div id="list-container" class="flex flex-col gap-3">
            <p id="loading-message" class="text-center text-gray-500 dark:text-gray-400">Loading tasks or signing in...</p>
        </div>
    </div>

    <!-- Notification Popup -->
    <div id="notification-popup" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow-xl text-sm font-medium">
        Task Added!
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-50">
        <div class="modal-content bg-white dark:bg-gray-800 p-6 rounded-lg shadow-2xl w-full max-w-sm">
            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Confirm Deletion</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-6">Are you sure you want to delete all tasks? This action cannot be undone.</p>
            <div class="flex justify-end gap-4">
                <button id="modal-cancel-btn" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg transition">Cancel</button>
                <button id="modal-confirm-btn" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition">Delete All</button>
            </div>
        </div>
    </div>

    <!-- Link to external JavaScript file -->
    <script type="module" src="script.js"></script>
</body>
</html>